{"version":3,"sources":["../../sniffer/zdaye.js"],"names":["page","fetch","saver","goto","waitForSelector","ipPortUrls","$eval","trs","document","querySelectorAll","i","length","tr","ip","querySelector","innerText","portUrl","src","push","cookies","ipPortUrl","portPicBuffer","follow","headers","Host","Accept","Referer","Cookie","map","x","name","value","join","then","res","buffer"],"mappings":"4EAAA;;;;;;;AAOe,gBAAgBA,IAAhB,EAAsBC,KAAtB,EAA6BC,KAA7B,EAAoC;AAC/C;AACA;AACA;;AAEA,UAAMF,KAAKG,IAAL,CAAU,0HAAV,CAAN;;AAEA,UAAMH,KAAKI,eAAL,CAAqB,MAArB,CAAN;AACA,UAAMC,aAAa,MAAML,KAAKM,KAAL,CAAW,MAAX,EAAmB,YAAY;AACpD,cAAMD,aAAa,EAAnB;AACA,cAAME,MAAMC,SAASC,gBAAT,CAA0B,8BAA1B,CAAZ;AACA,aAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIH,IAAII,MAAxB,EAAgCD,GAAhC,EAAqC;AACjC,kBAAME,KAAKL,IAAIG,CAAJ,CAAX;AACA,kBAAMG,KAAKD,GAAGE,aAAH,CAAiB,gBAAjB,EAAmCC,SAA9C;AACA,kBAAMC,UAAUJ,GAAGE,aAAH,CAAiB,uBAAjB,EAA0CG,GAA1D;AACAZ,uBAAWa,IAAX,CAAgB;AACZL,kBADY;AAEZG,uBAFY,EAAhB;;AAIH;AACD,eAAOX,UAAP;AACH,KAbwB,CAAzB;AAcA,UAAMc,UAAU,MAAMnB,KAAKmB,OAAL,EAAtB;AACA,SAAK,IAAIC,SAAT,IAAsBf,UAAtB,EAAkC;AAC9B,cAAMgB,gBAAgB,MAAMpB,MAAMmB,UAAUJ,OAAhB,EAAyB;AACjDM,oBAAQ,GADyC;AAEjDC,qBAAS;AACLC,sBAAM,cADD;AAELC,wBAAQ,yCAFH;AAGL,mCAAmB,eAHd;AAIL,8BAAc,mHAJT;AAKL,mCAAmB,gBALd;AAMLC,yBAAS,0HANJ;AAOLC,wBAAQR,QAAQS,GAAR,CAAYC,KAAM,GAAEA,EAAEC,IAAK,IAAGD,EAAEE,KAAM,EAAtC,EAAyCC,IAAzC,CAA8C,GAA9C,CAPH,EAFwC,EAAzB;;;AAY3BC,YAZ2B,CAYtBC,OAAOA,IAAIC,MAAJ,EAZe,CAA5B;AAaA;;AAEAjC,cAAO,GAAEkB,UAAUP,EAAG,MAAtB;AACH;AACJ,C","file":"zdaye.js","sourcesContent":["/**\r\n * 站大爷\r\n * 支持 https\r\n * 支持 post响应时间 < 1s\r\n * \r\n * http://ip.zdaye.com/FreeIPlist.html?ip=&adr=&checktime=&sleep=1&cunhuo=&nadr=&dengji=&https=1&yys=&post=%D6%A7%B3%D6&px=\r\n */\r\nexport default async function (page, fetch, saver) {\r\n    ////////////////////////////\r\n    return\r\n    ////////////////////////////\r\n\r\n    await page.goto('http://ip.zdaye.com/FreeIPlist.html?ip=&adr=&checktime=&sleep=1&cunhuo=&nadr=&dengji=&https=1&yys=&post=%D6%A7%B3%D6&px=')\r\n\r\n    await page.waitForSelector('#ipc')\r\n    const ipPortUrls = await page.$eval('#ipc', async () => {\r\n        const ipPortUrls = []\r\n        const trs = document.querySelectorAll('#ipc > tbody tr:not(.active)')\r\n        for (let i = 0; i < trs.length; i++) {\r\n            const tr = trs[i]\r\n            const ip = tr.querySelector('td:first-child').innerText\r\n            const portUrl = tr.querySelector('td:nth-child(3) > img').src\r\n            ipPortUrls.push({\r\n                ip,\r\n                portUrl,\r\n            })\r\n        }\r\n        return ipPortUrls\r\n    })\r\n    const cookies = await page.cookies()\r\n    for (let ipPortUrl of ipPortUrls) {        \r\n        const portPicBuffer = await fetch(ipPortUrl.portUrl, {\r\n            follow: 200,\r\n            headers: {\r\n                Host: 'ip.zdaye.com',\r\n                Accept: 'image/webp,image/apng,image/*,*/*;q=0.8',\r\n                'Accept-Encoding': 'gzip, deflate',\r\n                'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3419.0 Safari/537.36',\r\n                'Accept-Language': 'zh-CN,zh;q=0.9',\r\n                Referer: 'http://ip.zdaye.com/FreeIPlist.html?ip=&adr=&checktime=&sleep=3&cunhuo=&nadr=&dengji=&https=1&yys=&post=%D6%A7%B3%D6&px=',\r\n                Cookie: cookies.map(x => `${x.name}=${x.value}`).join(';'),\r\n            }\r\n        })\r\n        .then(res => res.buffer())\r\n        // TODO: verification code recognition\r\n\r\n        saver(`${ipPortUrl.ip}:???`)\r\n    }\r\n}"]}