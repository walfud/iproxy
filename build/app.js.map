{"version":3,"sources":["../app.js"],"names":["setInterval","proxies","saver","proxy","Array","isArray","i","replace","length","push","file","fs","readdirSync","console","log","name","path","parse","require","default","app","Koa","use","root","Router","get","ctx","body","routes","listen"],"mappings":"aAAA,wB;AACA,4B;AACA,0B;AACA,uC;AACA,+C;AACA,uC;;AAEA;AACAA,YAAY,YAAY;AACpB;AACA,UAAMC,UAAU,EAAhB;AACA,aAASC,KAAT,CAAeC,KAAf,EAAsB;AAClB,YAAI,CAACC,MAAMC,OAAN,CAAcF,KAAd,CAAL,EAA2B;AACvBA,oBAAQ,CAACA,KAAD,CAAR;AACH;;AAED,aAAK,IAAIG,CAAT,IAAcH,KAAd,EAAqB;AACjB,gBAAIG,KAAKA,EAAEC,OAAF,CAAU,OAAV,EAAmB,EAAnB,EAAuBC,MAAvB,KAAkC,CAAvC,IAA4CF,EAAEC,OAAF,CAAU,OAAV,EAAmB,EAAnB,EAAuBC,MAAvB,KAAkC,CAAlF,EAAqF;AACjFP,wBAAQQ,IAAR,CAAaH,CAAb;AACH;AACJ;AACJ;AACD,SAAK,IAAII,IAAT,IAAiBC,aAAGC,WAAH,CAAe,WAAf,CAAjB,EAA8C;AAC1CC,gBAAQC,GAAR,CAAa,oBAAmBJ,IAAK,EAArC;;AAEA,cAAM,EAAEK,IAAF,KAAWC,eAAKC,KAAL,CAAWP,IAAX,CAAjB;AACAQ,gBAAS,aAAYH,IAAK,EAA1B,EAA6BI,OAA7B,CAAqCjB,KAArC;AACH;AACJ,CApBD,EAoBG,IAAI,IApBP;;AAsBA;AACA,CAAC,YAAY;AACT,UAAMkB,MAAM,IAAIC,aAAJ,EAAZ;AACAD,QAAIE,GAAJ,CAAQ,0BAAR;AACAF,QAAIE,GAAJ,CAAQ,8BAAR;;AAEA,UAAMC,OAAO,IAAIC,mBAAJ,EAAb;AACAD,SAAKE,GAAL,CAAS,GAAT,EAAcC,OAAO;AACjBA,YAAIC,IAAJ,GAAW,aAAX;AACH,KAFD;;AAIA;AACA,SAAK,IAAIjB,IAAT,IAAiBC,aAAGC,WAAH,CAAe,UAAf,CAAjB,EAA6C;AACzCC,gBAAQC,GAAR,CAAa,mBAAkBJ,IAAK,EAApC;;AAEA,cAAM,EAAEK,IAAF,KAAWC,eAAKC,KAAL,CAAWP,IAAX,CAAjB;AACAa,aAAKD,GAAL,CAAU,IAAGP,IAAK,EAAlB,EAAqBG,QAAS,YAAWH,IAAK,EAAzB,EAA4BI,OAA5B,CAAoCS,MAApC,EAArB;AACH;AACDR,QAAIE,GAAJ,CAAQC,KAAKK,MAAL,EAAR;;AAEAR,QAAIS,MAAJ,CAAW,IAAX;AACAhB,YAAQC,GAAR,CAAa,gBAAb;AACH,CArBD","file":"app.js","sourcesContent":["import fs from 'fs'\nimport path from 'path'\nimport Koa from 'koa'\nimport logger from 'koa-logger'\nimport bodyParser from 'koa-bodyparser'\nimport Router from 'koa-router'\n\n// Sniffer Service\nsetInterval(function () {\n    // TODO: mongodb\n    const proxies = []\n    function saver(proxy) {\n        if (!Array.isArray(proxy)) {\n            proxy = [proxy]\n        }\n\n        for (let i of proxy) {\n            if (i && i.replace(/[^.]/g, '').length === 3 && i.replace(/[^:]/g, '').length === 1) {\n                proxies.push(i)\n            }\n        } \n    }\n    for (let file of fs.readdirSync('./sniffer')) {\n        console.log(`loading sniffer: ${file}`)\n\n        const { name } = path.parse(file)\n        require(`./sniffer/${name}`).default(saver)\n    }\n}, 1 * 1000);\n\n// Server\n(function () {\n    const app = new Koa()\n    app.use(logger())\n    app.use(bodyParser())\n\n    const root = new Router()\n    root.get('/', ctx => {\n        ctx.body = 'Hello World'\n    })\n\n    // Load all routers\n    for (let file of fs.readdirSync('./router')) {\n        console.log(`loading module: ${file}`)\n\n        const { name } = path.parse(file)\n        root.use(`/${name}`, require(`./router/${name}`).default.routes())\n    }\n    app.use(root.routes())\n\n    app.listen(3000)\n    console.log(`Listen at 3000`)\n})();"]}